version: '3.8'

services:
  server:
    container_name: server
    build:
      context: ./server
    ports:
      - "3000"
    environment:
      - ORIGIN=${ORIGIN}
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.server.rule=Host(`coolify.io`) && PathPrefix(`/server`)"
      - "traefik.http.routers.server.entrypoints=http"
      - "traefik.http.services.server.loadbalancer.server.port=3000"

  client:
    container_name: client
    build:
      context: ./client
    ports:
      - "80"
    environment:
      - VITE_APP_API_URL=${VITE_APP_API_URL}
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.client.rule=Host(`coolify.io`)"
      - "traefik.http.routers.client.entrypoints=http"
      - "traefik.http.services.client.loadbalancer.server.port=80"